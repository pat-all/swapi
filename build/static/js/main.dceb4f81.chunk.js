(window.webpackJsonpswapi=window.webpackJsonpswapi||[]).push([[0],{29:function(e,t,n){e.exports=n(55)},34:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(13),o=n.n(a),l=(n(34),n(2)),i=(n(39),n(3)),u=n(11),s=(n(40),n(12)),m=(n(41),function(e){var t=e.children;return c.a.createElement("button",{className:"header-item header-button"},t)}),g=(n(42),function(){var e=Object(r.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],o=Object(u.f)().pathname.split("/")[1];return c.a.createElement("div",{className:"search"},c.a.createElement("input",{type:"text",placeholder:"Search",value:n,onChange:function(e){a(e.target.value)}}),c.a.createElement(m,null,c.a.createElement(i.b,{to:"/".concat(o,"/?search=").concat(n)},"Search")))}),f=n(16),E=n.n(f),d=(n(27),{string:/[a-z]+/,number:/[0-9]+/,page:/\?page=[0-9]+/,search:/\?search=.+/}),h="CATEGORY",p=function(e){return d.page.test(e)},v=function(e){return e[Object.keys(e)[0]]},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.category,n=e.page,r=e.search,c=e.url;return!t||n||r?t&&n>0&&!r?"".concat("/api","/").concat(t,"/?page=").concat(n):t&&!n&&r?"".concat("/api","/").concat(t,"/?search=").concat(r):!c||t||n||r?"/api":"".concat("/api").concat(c):"".concat("/api","/").concat(t)},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.string,n=e.number;return t?t.match(d.string)[0]:n?"number"===typeof n?n:n.match(d.number)[0]:null},j=function(e){return e.includes("https://swapi.co/api")?e.replace("https://swapi.co/api",""):e},O=function(e,t){var n=j(t),r=e[y({string:n})],c=N(r,{fieldName:"url",fieldValue:t}),a=c.length>0?c[0]:null;return a?v(a):null},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.pages,r=t.fieldName,c=t.fieldValue,a="url"===r,o=[];if(n&&r&&c){for(var l=0;l<n.length;l++){var i=n[l];if(i)for(var u=0;u<i.length;u++){var s=i[u];if(s[r].includes(c)&&(o.push(s),a))return o}if(a&&o.length>0)return o}return o}return o},k=function(e){return function(e){return d.search.test(e)}(e)?e.replace("?search=",""):null},C=n(14),w=Object(C.b)({slice:"errors",initialState:{connectionError:{isError:!1,log:""},notFoundError:{isError:!1,type:void 0,log:""}},reducers:{setConnectionError:function(e,t){var n=t.payload,r=n.isError,c=n.log;e.connectionError={isError:r,log:c}},setNotFoundError:function(e,t){var n=t.payload,r=n.isError,c=n.log,a=n.type;e.notFoundError={isError:r,log:c,type:a}}}}),F=w.actions,A=F.setConnectionError,S=F.setNotFoundError,q=w.reducer,P=Object(C.b)({slice:"categories",initialState:{isFetching:!1,entities:{}},reducers:{requestAll:function(e){e.isFetching=!0},receiveAll:function(e,t){e.isFetching=!1,Object.keys(t.payload).map(function(t){return e.entities[t]={count:0,activePage:1,pages:[],search:{query:"",results:[]}}})},requestPage:function(e,t){},receivePage:function(e,t){var n=t.payload,r=n.category,c=n.json,a=n.page,o=c.count,l=c.results;e.entities[r].count=o,e.entities[r].pages[a]=l},setActivePage:function(e,t){var n=t.payload,r=n.category,c=n.page;e.entities[r].activePage=Number(c)},requestItem:function(e,t){},receiveItem:function(e,t){var n=t.payload,r=n.category,c=n.json;e.entities[r].pages[0]?e.entities[r].pages[0].push(c):e.entities[r].pages[0]=[c]},cancelFetching:function(e){e.isFetching=!1},searchRequest:function(e,t){},receiveSearchData:function(e,t){var n=t.payload,r=n.category,c=n.query,a=n.json.results,o=e.entities[r].pages;e.entities[r].search={query:c,results:a},a.forEach(function(t){0===N(e.entities[r],{fieldName:"url",fieldValue:t.url}).length&&(o[0]?o[0].push(t):o[0]=[t])})}}}),H=P.actions,x=H.requestAll,T=H.receiveAll,I=H.requestItem,R=H.receiveItem,D=H.setActivePage,V=H.requestPage,B=H.receivePage,M=(H.fetchDataFail,H.cancelFetching),W=H.searchRequest,G=H.receiveSearchData,J=P.reducer,U={"Access-Control-Allow-Origin":"http://localhost:3000/","Access-Control-Allow-Methods":"GET, POST, PUT","Access-Control-Allow-Headers":"Content-Type","Content-Type":"application/json"},z=function(e){return function(t){(function(e){var t=e.entities,n=e.isFetching,r=Object.keys(t).length;return(0!==r||!n)&&(0===r&&!n)})(e)&&t(function(e){return e(x()),E()(b(),{headers:U}).then(function(e){return e.json()}).then(function(t){return e(T(t))}).catch(function(t){console.log(t),e(M()),e(A({isError:!0,log:t.message}))})})}},Y=function(e,t){var n=t.category,r=t.page;return function(t){(function(e,t){var n=e.pages;return!(n[t]&&n[t].length>0)})(e,r)&&t(function(e){var t=e.category,n=e.page;return function(e){return e(V({category:t,page:n})),E()(b({category:t,page:n},{headers:U})).then(function(e){return e.json()}).then(function(r){return e(B({category:t,json:r,page:n}))}).catch(function(t){console.log(t),e(M()),e(A({isError:!0,log:t.message}))})}}({category:y({string:n}),page:y({number:r})}))}},$=function(e,t,n){return function(r){0===N(e,{url:n}).length&&r(function(e){var t=e.category,n=e.url;return function(e){return e(I({url:n})),E()(b({url:n})).then(function(e){return e.json()}).then(function(n){return e(R({category:t,json:n}))}).catch(function(t){console.log(t),e(M()),e(A({isError:!0,log:t.message}))})}}({category:t,url:n}))}},_=c.a.memo(function(){var e=Object(l.c)(function(e){return e.categories}),t=Object(l.c)(function(e){return e.errors.connectionError.isError}),n=Object.keys(e.entities),a=Object(l.b)();return Object(r.useEffect)(function(){t||a(z(e))}),c.a.createElement("header",null,c.a.createElement("div",{className:"header-section"},c.a.createElement("div",{className:"header-logo header-item"},"SWAPI"),c.a.createElement("div",{className:"header-item nav-top"},c.a.createElement(i.c,{exact:!0,to:"/",activeClassName:"selected"},"home")),n.map(function(e){return c.a.createElement("div",{key:e,className:"header-item nav-top"},c.a.createElement(i.c,{to:"/".concat(e),activeClassName:"selected"},e))})),c.a.createElement("div",{className:"header-section"},c.a.createElement(g,null)))}),K=(n(45),function(){return c.a.createElement("div",null,c.a.createElement("h2",null,"Hello, this is Home component"))}),L=(n(46),n(47),function(){var e=Object(u.h)().url,t=Object(l.b)(),n=Object(u.g)().category,a=Object(l.c)(function(e){return e.categories}),o=a.entities,s=a.isFetching,m=Object(l.c)(function(e){return e.errors}).connectionError,g=o[n],f=[],E=[],d=null;return Object(r.useEffect)(function(){s||m.isError||!g||d||t($(g,n,e))}),!s&&g&&e&&!d&&(E=N(g,{fieldName:"url",fieldValue:e}),f=(d=E.length>0?E[0]:null)?Object.keys(d):[]),c.a.createElement("section",{className:"right-section"},c.a.createElement("div",{className:"data-container"},d&&f.length>0&&f.map(function(e,t){var n={background:t%2===0?"#efebe9":"transparent"};return c.a.createElement("div",{className:"row",key:t,style:n},c.a.createElement("div",{className:"left-cell"},e.replace(/_/g," ")),c.a.createElement("div",{className:"right-cell"},Array.isArray(d[e])?d[e].map(function(e,t){return c.a.createElement(c.a.Fragment,{key:t},c.a.createElement(i.b,{to:j(e)},O(o,e)?O(o,e):j(e))," ",c.a.createElement("br",null))}):function(e){return/https/.test(e)}(d[e])&&j(d[e])?c.a.createElement(i.b,{to:j(d[e])},"url"!==e&&O(o,d[e])?O(o,d[e]):j(d[e])):d[e]))})))}),Q=(n(48),n(49),function(e){var t=e.title,n=e.to;return c.a.createElement("div",{className:"left-section-item"},c.a.createElement(i.c,{to:n,activeClassName:"selected-left"},c.a.createElement("h5",null,t)))}),X=(n(50),n(51),function(e){var t,n=e.children,r=e.to,a=e.clickHandler,o=e.style;return console.log(o),c.a.createElement("button",{className:"page-button",onClick:a,style:o},r?c.a.createElement(i.b,{to:(t=r,t.replace("//","/"))},n):n)}),Z=function(e){var t=e.page,n=e.pagesCount,a=t>1,o=t>2,l=t<n,i=n-t>1,m=Object(r.useState)([]),g=Object(s.a)(m,2),f=g[0],E=g[1],d=Object(r.useState)([]),h=Object(s.a)(d,2),p=h[0],v=h[1],b=Object(r.useState)(!1),y=Object(s.a)(b,2),j=y[0],O=y[1],N=Object(r.useState)(!1),k=Object(s.a)(N,2),C=k[0],w=k[1],F=Object(u.h)().url,A=function(){w(!1),O(!1)};return c.a.createElement("div",{className:"pagination"},f.length>0&&j&&c.a.createElement(ee,{nums:f,clicHandler:A}),p.length>0&&C&&c.a.createElement(ee,{nums:p,clicHandler:A}),c.a.createElement("ul",null,a&&c.a.createElement("li",{onClick:A},c.a.createElement(X,{to:"".concat(F,"/?page=").concat(t-1)},"<")),o&&c.a.createElement("li",{onClick:function(){for(var e=[],n=1;n<t;n++)e.push(n);E(e),O(!j),w(!1)}},c.a.createElement(X,null,"...")),c.a.createElement("li",{onClick:A},c.a.createElement(X,null,t)),i&&c.a.createElement("li",{onClick:function(){for(var e=[],r=t+1;r<=n;r++)e.push(r);v(e),w(!C),O(!1)}},c.a.createElement(X,null,"...")),l&&c.a.createElement("li",{onClick:A},c.a.createElement(X,{to:"".concat(F,"/?page=").concat(t+1)},">"))))},ee=function(e){var t=e.nums,n=e.clicHandler,r=t.length>=4?4:t.length,a=function(e,t){var n=Math.floor(e/(t+1))+1,r=e%t===0?t:e%t;return{gridColumn:"".concat(r," / ").concat(r+1),gridRow:"".concat(n," / ").concat(n+1)}},o=Object(u.h)().url;return c.a.createElement("div",{className:"page-buttons-container",style:{"grid-template-columns":"repeat(".concat(r,", 39px)")}},t.map(function(e,t){return console.log(t+1),c.a.createElement(X,{key:e,to:"".concat(o,"/?page=").concat(e),clickHandler:n,style:a(t+1,4)},e)}))},te=function(){var e,t=Object(u.g)().category,n=Object(u.f)(),a=n.pathname,o=n.search,i="/".concat(t,"/")===a?p(e=o)?e.match(d.number)[0]:1:void 0,s="/".concat(t,"/")===a&&k(o)&&k(o).trim().length>0?k(o).trim():null,m=Object(l.c)(function(e){return e.categories}),g=m.entities,f=m.isFetching,y=Object(l.c)(function(e){return e.errors}),O=y.connectionError,N=y.notFoundError,C=g[t],w=C?C.activePage:1,F=Object.keys(g),A=F.length,q=Object(l.b)(),P=C&&C.count?C.count:0,H=P?Math.ceil(P/10):0,x=[],T=0;return Object(r.useEffect)(function(){A>0&&!O.isError&&(F.includes(t)?(N.isError&&q(S({isError:!1,type:void 0,log:""})),s?C.search.query!==s&&q(function(e,t){return function(n){if(e&&t)return n(W({category:e,search:t})),E()(b({category:e,search:t})).then(function(e){return e.json()}).then(function(r){return n(G({category:e,query:t,json:r}))}).catch(function(e){console.log(e)})}}(t,s)):q(Y(C,{category:t,page:w}))):q(S({isError:!0,type:h,log:t})))}),Object(r.useEffect)(function(){!f&&!O.isError&&C&&p(o)&&!s&&i&&q(D({category:t,page:i}))}),C&&C.pages&&C.pages[w]&&!s?T=(x=C.pages[w]).length:C&&C.search&&s&&C.search.query===s&&(x=C.search.results),c.a.createElement("section",{className:"left-section"},x.map(function(e,t){return c.a.createElement(Q,{key:t,title:v(e),to:j(e.url)})}),H>1&&c.a.createElement(Z,{page:w,pagesCount:H}),T>0&&c.a.createElement("div",{className:"legend"},"".concat(10*(w-1)+1," - ").concat(10*(w-1)+T," of ").concat(P)))},ne=c.a.memo(function(){var e=Object(u.h)().path;return c.a.createElement("section",{className:"category-section"},c.a.createElement(te,null),c.a.createElement(u.c,null,c.a.createElement(u.a,{exact:!0,path:e},"Select item from left part"),c.a.createElement(u.a,{path:"".concat(e,"/:id"),component:L})))});var re=function(e){var t=Object(r.useRef)(null);return Object(r.useEffect)(function(){var n,r=document.querySelector("#".concat(e)),c=r||function(e){var t=document.createElement("div");return t.setAttribute("id",e),t}(e);return r||(n=c,document.body.insertBefore(n,document.body.lastElementChild.nextElementSibling)),c.appendChild(t.current),function(){t.current.remove(),-1===c.childNodes.length&&c.remove()}}),t.current||(t.current=document.createElement("div")),t.current},ce=(n(52),function(e){var t=e.id,n=e.children,r=re(t);return Object(a.createPortal)(c.a.createElement("div",{className:"modal"}," ",n),r)}),ae=(n(53),function(){return c.a.createElement("div",{className:"loading"},c.a.createElement("div",{className:"dot d1"}),c.a.createElement("div",{className:"dot d2"}),c.a.createElement("div",{className:"dot d3"}))}),oe=(n(54),function(){var e=Object(l.c)(function(e){return Object.keys(e.categories.entities)}),t=Object(l.c)(function(e){return e.errors}),n=t.connectionError,r=t.notFoundError,a=n.isError?".error-page .error-modal":".error-page";return c.a.createElement("div",{className:a},n.isError&&c.a.createElement("h2",null,n.log),!n.isError&&r.isError&&c.a.createElement(c.a.Fragment,null,c.a.createElement("h3",null,"Error: ".concat(r.log," is NOT FOUND, try:")),c.a.createElement("ul",null,e.map(function(e,t){return c.a.createElement("li",{key:t},c.a.createElement(i.b,{to:"/".concat(e,"/")},"/".concat(e,"/")))}))))}),le=function(){var e=Object(l.c)(function(e){return e.categories}),t=Object(l.c)(function(e){return e.errors}),n=t.notFoundError,r=t.connectionError,a=e.isFetching;return c.a.createElement("div",{className:"App"},c.a.createElement(i.a,null,c.a.createElement(_,null),c.a.createElement(u.c,null,c.a.createElement(u.a,{exact:!0,path:"/",component:K}),c.a.createElement(u.a,{path:"/:category"},n.isError?c.a.createElement(oe,null):c.a.createElement(ne,null)))),a&&!r.isError&&c.a.createElement(ce,{id:"modal-root"},c.a.createElement(ae,null)),r.isError&&c.a.createElement(ce,{id:"modal-root"},c.a.createElement(oe,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ie=n(5),ue=Object(ie.combineReducers)({errors:q,categories:J}),se=Object(C.a)({reducer:ue});o.a.render(c.a.createElement(l.a,{store:se},c.a.createElement(le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[29,1,2]]]);
//# sourceMappingURL=main.dceb4f81.chunk.js.map